<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-12-23 Sat 13:33 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sicp</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="ying dai" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
<link href='http://apps.bdimg.com/libs/highlight.js/9.1.0/styles/zenburn.min.css' rel='stylesheet'>
<script src='http://apps.bdimg.com/libs/highlight.js/9.1.0/highlight.min.js'></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel='stylesheet' href='../css/worg2.css' typbe='text/css'/>
<link rel='shortcut icon' type='image/x-icon' href='/favicon.ico'>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src='https://www.googletagmanager.com/gtag/js?id=UA-111585106-1'></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-111585106-1');
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>
<body>
<div id="preamble" class="status">

<div class='nav'>
<div class='blog' style='text-align:right'>
<a href='/index.html'> Home </a> | <a href='/contact.html'> About </a>
</div>
</div>
</div>
<div id="content">
<h1 class="title">sicp</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org6856a3b">Chapter 1 Building Abstractions with Procedures</a>
<ul>
<li><a href="#orge2591c6">The Elements of Programming</a></li>
<li><a href="#orged7acb5">Procedures and the Processes They Generate</a></li>
<li><a href="#orgda7d459">Formulating Abstractions with Higher-Order Procedures</a></li>
</ul>
</li>
<li><a href="#orge62ca3d">Chapter 2 Building Abstractions with Data</a>
<ul>
<li><a href="#orgf0f19c6">Introduction to Data Abstraction</a></li>
<li><a href="#org5a46b9c">Hierarchical Data and the Closure Property</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org6856a3b" class="outline-2">
<h2 id="org6856a3b">Chapter 1 Building Abstractions with Procedures</h2>
<div class="outline-text-2" id="text-org6856a3b">
<blockquote>
<p>
The acts of the mind, wherein it exerts its power over simple
ideas, are chiefly these three: 1. Combining several simple ideas
into one compound one, and thus all complex ideas are made. 2. The
second is bringing two ideas, whether simple or complex,
together, and seting them by one another so as to take a view of
them at once, without uniting them into one, by which it gets all
its ideas of relations. 3. The third is separating them from all
other ideas that accompany them in their real existence: this is
called abstraction, and thus all its general ideas are made.
</p>

<p>
—John Locke, An Essay Concerning Human Understanding (1690)
</p>
</blockquote>
</div>


<div id="outline-container-orge2591c6" class="outline-3">
<h3 id="orge2591c6">The Elements of Programming</h3>
<div class="outline-text-3" id="text-orge2591c6">
<p>
A powerful programming language is
more than just a means for
instructing a computer to perform
tasks. The language also serves as a
framework within which we organize
our idea about processes.
</p>

<p>
Every powerful language has three
mechanisms for accomplishing this:
</p>
<ul class="org-ul">
<li><code>primitive expressions</code>, which
represent the simplest entities
the language is concerned with.</li>
<li><code>means of combination</code>, by which
compound elements are build from
simpler ones, and</li>
<li><code>means of abstraction</code>, by which
compound elements can be named and
manipulated as units.</li>
</ul>

<p>
In programming, we deal with two kinds of elements:
procedures and data.
</p>
</div>

<ul class="org-ul"><li><a id="org6cc2dd8"></a>Expressions<br /><div class="outline-text-4" id="text-org6cc2dd8">
<p>
Expressions representing numbers
maybe combined with an expression
representing a primitive
procedures(such as + or *) to form a
compound expression of the procedure
to those numbers.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ 137 349<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>/ 5 99<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>+ 2.2 19<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
The convention of placing the operator to the left of
the operands is known as <code>prefix notation</code> , and it may be somewhat
confusing at first because it departs significantly from the
customary mathematical convention. Prefix notation has serveral
advantages. One of the is that it can accommodate
procedures that may take an arbitrary number of arguments, as the
following examples:
</p>


<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ 12 23 43 4<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>* 33  85 2<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
A second advantage of prefix
notation is that it extends in a
straightforward way to allow
combinations to be nested, that is,
to have combinations whose
elements are themselves
combinations:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>* 3 5<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>- 10 6<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
There is no limit to the depth of such nesting.
</p>

<p>
Instead to write the code like in one line:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>* 3 <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>* 2 4<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>+ 3 5<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>+ <span class="org-rainbow-delimiters-depth-3">(</span>- 10 7<span class="org-rainbow-delimiters-depth-3">)</span> 6<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
We can write it to the following form as pretty-printing:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>* 3
      <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>* 2 4<span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>+ 3 5<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
   <span class="org-rainbow-delimiters-depth-2">(</span>+ <span class="org-rainbow-delimiters-depth-3">(</span>- 10 7<span class="org-rainbow-delimiters-depth-3">)</span>
      6<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>
</div></li>

<li><a id="org507535c"></a>Naming and the Environment<br /><div class="outline-text-4" id="text-org507535c">
<p>
In the Scheme, we name things with <code>define</code> .
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">size</span> 2<span class="org-rainbow-delimiters-depth-1">)</span>

size

<span class="org-rainbow-delimiters-depth-1">(</span>* 5 size<span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>

<p>
Here are further examples of the use of <code>define</code> :
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">pi</span> 3.14<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">radius</span> 10<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">curcumference</span> <span class="org-rainbow-delimiters-depth-2">(</span>* 2 pi radius<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>


<li><a id="org772d196"></a>Evaluating Combinations<br /><div class="outline-text-4" id="text-org772d196">
<p>
For example,evaluating
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>* <span class="org-rainbow-delimiters-depth-2">(</span>+ 2 <span class="org-rainbow-delimiters-depth-3">(</span>* 4 6<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
   <span class="org-rainbow-delimiters-depth-2">(</span>+ 3 5 7<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
requires that the evaluation rule be applied to four
different combinations. We can obtain a picture of this
process by representing the combination in the form of a tree
, as shown in blow. The terminal nodes represent either
operators or numbers.
</p>


<div class="figure">
<p><img src="./imgs/20170606_164720_53196PP.png" alt="20170606_164720_53196PP.png" />
</p>
</div>
</div></li>

<li><a id="org00caaa2"></a>Compound Procedures<br /><div class="outline-text-4" id="text-org00caaa2">
<p>
Now we will learn about <code>procedure definitions</code> , a much
more powerful abstraction by which a compound operation
can be given a name and then referred to as a unit. Like:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">square</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* x x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>square 21<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>square <span class="org-rainbow-delimiters-depth-2">(</span>+ 2 5<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>square <span class="org-rainbow-delimiters-depth-2">(</span>square 3<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
The general form of a procedure definition is
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">&lt;name&gt;</span> &lt;formal parameters<span class="org-rainbow-delimiters-depth-2">)</span>
<span class="org-type">&lt;body&gt;</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
For example, \(x^2 + y^2\) can be expressed as
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>square x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>square y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
<a id="org386f2c6"></a>
</p>
</div></li>
<li><a id="org1714c2f"></a>The Substitution Model for Procedure Application<br /><div class="outline-text-4" id="text-org1714c2f">
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>f 5<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>sum-of-squares <span class="org-rainbow-delimiters-depth-2">(</span>+ a 1<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* a 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>sum-of-squares <span class="org-rainbow-delimiters-depth-2">(</span>+ 5 1<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* 5 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>square 6<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>square 10<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>* 6 6<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* 10 10<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ 36 100<span class="org-rainbow-delimiters-depth-1">)</span>
136
</code></pre>
</div>

<p>
The process we have just described is called the <code>substitution model</code> for
procedure application.
</p>
</div></li>

<li><a id="org9f3efd2"></a>Applicative order versus normal order<br /><div class="outline-text-4" id="text-org9f3efd2">
<p>
The above way is not the only way to perform evaluation.
An alternative evalution model would not evaluate the
operands until their values were needed. Instead it first
substitute operand expressions for parameters until it
obtained an expression involving only primitive operators,
and then perform the evaluation.
</p>

<p>
In this place, We still use the (f 5) as an example.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>sum-of-squares <span class="org-rainbow-delimiters-depth-2">(</span>+ 5 1<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* 5 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>square <span class="org-rainbow-delimiters-depth-3">(</span>+ 5 1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>square <span class="org-rainbow-delimiters-depth-3">(</span>* 5 2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>*<span class="org-rainbow-delimiters-depth-3">(</span>+51<span class="org-rainbow-delimiters-depth-3">)(</span>+51<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>*<span class="org-rainbow-delimiters-depth-3">(</span>*52<span class="org-rainbow-delimiters-depth-3">)(</span>*52<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>+ <span class="org-rainbow-delimiters-depth-2">(</span>* 6 6<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* 10 10<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>+  36 100<span class="org-rainbow-delimiters-depth-1">)</span>
136
</code></pre>
</div>

<p>
This method is called <code>normal-order evaluation</code> with fully
expand and then reduce evaluation method, in contrast
to the "evaluate the arguments and the apply" method that
the interpreter actually uses, which is called <code>applicative-order evaluation</code> .
</p>
</div></li>

<li><a id="org42f2ba7"></a>Conditional Expressions and Predicates<br /><div class="outline-text-4" id="text-org42f2ba7">
<p>
Now, we will do like this:
\[ |x| =\left\{ \begin{aligned} x & , & if & & x > 0 \\ 0 & , & if
   & & x = 0 \\ -x & , & if & & x < 0\end{aligned} \right.\]
</p>

<p>
We will compute the absolute value of a number by testing whether the number is
positive, negative, or zero.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">abs</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&gt; x 0<span class="org-rainbow-delimiters-depth-4">)</span> x<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= x 0<span class="org-rainbow-delimiters-depth-4">)</span> 0<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&lt; x 0<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>- x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">or this</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">abs</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&lt; x 0<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>- x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
           <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">if</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">abs</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&lt; x 0<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>- x<span class="org-rainbow-delimiters-depth-3">)</span>
        x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>


<p>
The general form of a conditional expression is
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">&#10216;</span>p1<span class="org-rainbow-delimiters-depth-3">&#10217;</span> <span class="org-rainbow-delimiters-depth-3">&#10216;</span>e1<span class="org-rainbow-delimiters-depth-3">&#10217;</span><span class="org-rainbow-delimiters-depth-2">)</span>
      <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">&#10216;</span>p2<span class="org-rainbow-delimiters-depth-3">&#10217;</span> <span class="org-rainbow-delimiters-depth-3">&#10216;</span>e2<span class="org-rainbow-delimiters-depth-3">&#10217;</span><span class="org-rainbow-delimiters-depth-2">)</span>
        ...
      <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">&#10216;</span>pn<span class="org-rainbow-delimiters-depth-3">&#10217;</span> <span class="org-rainbow-delimiters-depth-3">&#10216;</span>en<span class="org-rainbow-delimiters-depth-3">&#10217;</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
There are logical composition operations, which enable us
to construct compound predicates.
</p>
<ul class="org-ul">
<li>(and &lt;e<sub>1</sub>&gt; &#x2026; &lt;e<sub>n</sub>&gt;) If any &lt;e&gt; evaluates to false, the value
of the and expression is false, and the rest of &lt;e&gt;'s are not
evaluated.</li>

<li>(or &#x2026;.) Any is ture, then return true. If all is false, then return false.</li>

<li>(not &#x2026;.)</li>
</ul>

<p>
As an example of how these are used. Such \(x\) be in the range \(5 < x < 10\) may be expressed as
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-2">(</span>&gt; x 5<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>&lt; x 10<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
As another example, we can define a predicate to test whether one
number is greater than or equal to another as:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">&gt;=</span> x y<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">or</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; x y<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">&#65288;</span>= x y<span class="org-rainbow-delimiters-depth-3">&#65289;</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">or</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">&gt;=</span> x y<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>not <span class="org-rainbow-delimiters-depth-3">(</span>&lt; x y<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>

<li><a id="org5674ffa"></a>Example: Square Roots by Newton's Method<br /><div class="outline-text-4" id="text-org5674ffa">
<p>
Procedures are much like ordinary mathematical
functions. But there is an important difference
between mathematical functions and computer procedures.
Procedures must be effective.
</p>

<p>
As a case in point, consider the problem of computing square roots.
We can define the square-root function as
\[
   \sqrt x = the \  y \  such \ that \ y \ge 0 \ and \; y^2 = x.
   \]
</p>

<p>
This describes a perfectly legitimate mathematical function. We could use it
to recognize whether one number is the square root of another. On the other
hand, the definition does not describe a procedure. Indeed, it tells us nothing about how to actually find
the square root of a give number.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sqrt</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>the y <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-4">(</span>&gt; y 0<span class="org-rainbow-delimiters-depth-4">)</span>
            <span class="org-rainbow-delimiters-depth-4">(</span>= <span class="org-rainbow-delimiters-depth-5">(</span>square y<span class="org-rainbow-delimiters-depth-5">)</span> x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
In mathematics we are usually concerned with
declarative(what is) descriptions, whereas in
computer science we are usually concerned with
imperative(how to) descriptions.
</p>

<p>
<a href="https://en.wikipedia.org/wiki/File:NewtonIteration_Ani.gif">Square root by Newton's method</a>
</p>

<p>
We write this basic strategy as a procedure:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sqrt-iter</span> guess x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>good-enough? guess x<span class="org-rainbow-delimiters-depth-3">)</span>
        guess
        <span class="org-rainbow-delimiters-depth-3">(</span>sqrt-iter <span class="org-rainbow-delimiters-depth-4">(</span>improve guess x<span class="org-rainbow-delimiters-depth-4">)</span> x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">improve</span> guess x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>average guess <span class="org-rainbow-delimiters-depth-3">(</span>/ x guess<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">average</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>/ <span class="org-rainbow-delimiters-depth-3">(</span>+ x y<span class="org-rainbow-delimiters-depth-3">)</span> 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">square</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>* x x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">good-enough?</span> guess x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>&lt; <span class="org-rainbow-delimiters-depth-3">(</span>abs <span class="org-rainbow-delimiters-depth-4">(</span>- <span class="org-rainbow-delimiters-depth-5">(</span>square guess<span class="org-rainbow-delimiters-depth-5">)</span> x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> 0.001<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sqrt</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>sqrt-iter 1.0 x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
So, we can use <i>sqrt</i> to compute square root.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>sqrt 9<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>sqrt <span class="org-rainbow-delimiters-depth-2">(</span>+ 100 37<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>

<li><a id="org7e5104a"></a>Supplement of Newton's Method:<br /><div class="outline-text-4" id="text-org7e5104a">
<p>
(If you want see more detail, please visit <a href="https://en.wikipedia.org/wiki/Newton's_method">here</a>)
</p>


<div class="figure">
<p><img src="./imgs/20170607_121804_5319HaV.png" alt="20170607_121804_5319HaV.png" />
</p>
<p><span class="figure-number">Figure 2: </span>My understand of Newton's Method</p>
</div>


<div class="figure">
<p><img src="./imgs/newton-method.gif" alt="newton-method.gif" />
</p>
<p><span class="figure-number">Figure 3: </span>From wikipedia of Newton's Method</p>
</div>
</div></li>

<li><a id="org94c47ff"></a>Procedures as Black-Box Abstractions<br /><div class="outline-text-4" id="text-org94c47ff">
<p>
In the previous problem, we talk about the sqrt.
Notice that the definition of sqrt-iter is recursive.
This will be addressed more carefully in later section.
</p>

<p>
The importance of this decomposition strategy is not
simply that one is dividing the program into parts.
</p>

<p>
So, a precedure definition should be able to suppress
detail. The users of the procedure may not have written
the procedure themselves, but may have obtained it from
another programmer as a black box. A user should not need
to know how the procedure is implemented in order to use it.
</p>
</div></li>

<li><a id="org549e4f4"></a>Local names<br /><div class="outline-text-4" id="text-org549e4f4">
<p>
The simplest consequence is that the parameter of a procedure
must be local to the body of the procedure.
</p>
</div></li>

<li><a id="org98ca863"></a>Internal definitions and block structure<br /><div class="outline-text-4" id="text-org98ca863">
<p>
We would like to localize the subprocedures, hiding them inside
sqrt so that sqrt could coexist with other successive
approximations, each having its own private good enough?
procedure. To make this possible, we allow a procedure to have
internal definitions that are local to that procedure. For
example, in the square root problem we can write.
</p>


<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sqrt</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">square</span> x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>* x x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">average</span> x y<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>/ <span class="org-rainbow-delimiters-depth-4">(</span>+ x y<span class="org-rainbow-delimiters-depth-4">)</span> 2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">good-enough?</span> guess x<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>&lt; <span class="org-rainbow-delimiters-depth-4">(</span>abs <span class="org-rainbow-delimiters-depth-5">(</span>- <span class="org-rainbow-delimiters-depth-6">(</span>square guess<span class="org-rainbow-delimiters-depth-6">)</span> x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> 0.001<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">improve</span> guess x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>average guess <span class="org-rainbow-delimiters-depth-4">(</span>/ x guess<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">sqrt-iter</span> guess x<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>good-enough? guess x<span class="org-rainbow-delimiters-depth-4">)</span> guess
            <span class="org-rainbow-delimiters-depth-4">(</span>sqrt-iter <span class="org-rainbow-delimiters-depth-5">(</span>improve guess x<span class="org-rainbow-delimiters-depth-5">)</span> x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
      <span class="org-rainbow-delimiters-depth-2">(</span>sqrt-iter 1.0 x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
Such nesting of definitions, called block structure.
</p>
</div></li></ul>
</div>

<div id="outline-container-orged7acb5" class="outline-3">
<h3 id="orged7acb5">Procedures and the Processes They Generate</h3>
<div class="outline-text-3" id="text-orged7acb5">
<p>
To become experts, we must learn to visualize the
processes generated by various types of procedures.
Only after we have developed such a skill can we learn to
reliably construct programs that exhibit the desired
behavior.
</p>
</div>

<ul class="org-ul"><li><a id="org9eceff0"></a>Linear Recursion and Iteration<br /><div class="outline-text-4" id="text-org9eceff0">
<p>
We begin by considering the factorial function, defined by
\[
	n! = n \cdot (n-1) \cdot (n-2) \cdots 3 \cdot 2 \cdot 1
    \]
</p>

<p>
Thus, we can compute \(n!\) by computing \((n-1)!\) and
multiplying the result by \(n\).
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">factorial</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= n 1<span class="org-rainbow-delimiters-depth-3">)</span>
        1
        <span class="org-rainbow-delimiters-depth-3">(</span>* n <span class="org-rainbow-delimiters-depth-4">(</span>factorial <span class="org-rainbow-delimiters-depth-5">(</span>- n 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>


<p>
We can use the substitution model of <a href="#org386f2c6">This section</a> to watch this procedure
in action computing \(6!\), as show in <a href="#orgb90f7ed">Figure 4</a>.
</p>


<div id="orgb90f7ed" class="figure">
<p><img src="./imgs/20170607_204838_5319Ukb.png" alt="20170607_204838_5319Ukb.png" />
</p>
<p><span class="figure-number">Figure 4: </span>A linear recursive process for computing 6!</p>
</div>

<p>
Now let's take a different perspective on computing factorial.
We could describe a rule for computing \(n!\).
</p>

\begin{align}
product & \Leftarrow counter * product\\
counter & \Leftarrow counter + 1
\end{align}

<p>
Once again, we can recast our description as a procedure
for computing factorials.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">factorial</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>fact-iter 1 1 n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fact-iter</span> product counter max-count<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; counter max-count<span class="org-rainbow-delimiters-depth-3">)</span>
        product
        <span class="org-rainbow-delimiters-depth-3">(</span>fact-iter <span class="org-rainbow-delimiters-depth-4">(</span>* product counter<span class="org-rainbow-delimiters-depth-4">)</span>
                    <span class="org-rainbow-delimiters-depth-4">(</span>+ counter 1<span class="org-rainbow-delimiters-depth-4">)</span>
                    max-count<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
As before, we can use the substitution mode to visualize
the process of computing \(6!\), as shown in <a href="#org5ff6984">Figure</a>
</p>


<div id="org5ff6984" class="figure">
<p><img src="./imgs/20170608_102359_5319_pO.png" alt="20170608_102359_5319_pO.png" />
</p>
<p><span class="figure-number">Figure 5: </span>A linear iterative process for computing 6!</p>
</div>


<p>
Compare the two process. We can find the "shapes" of the two processs
are quite differently.
</p>

<p>
In the next, we'll talk about the difference between
<i>linear recursive process</i> and <i>linear iterative process</i>.
</p>

<p>
Consider the first process. The expansion occurs as the
process builds up a chain of <i>deferred operations</i>. This
python of process, characterized by a chain of deferred
operations, is called a <i>recursive process</i>. Carrying out the
process requires that the iterpreter keep track of the
operations to be performed later on.
</p>

<p>
By contrast, the second process does not grow and shrink.  At each
step, all we need to keep track of, for any n, are the current
values of the variables product, counter, and maxcount.  We call
this an <i>iterative process</i>. In general, an iterative process is one
whose state can be summarized by a fixed number of state
variables, together with a fixed rule that describes how the state
variables should be updated as the process moves from state to
state and an (optional) end test that specifies conditions under
which the process should terminate.
</p>

<p>
Understand the difference between <i>recursive process</i> and <i>recursive
procedure</i>. It may seem disturbing that we refer to a recursive
procedure such as factiter as generating an iterative
process. However, the process really is iterative. In the
page of <b>45</b> , there has more detail about this. <b>Must read this part once again</b>.
</p>

<p>
It will execute an iterative process in constant space, even if
the iterative process is described by a recursive procedure. An
implementation with this property is called tail-recursive.
</p>
</div></li>

<li><a id="org777960f"></a>Tree Recusion<br /><div class="outline-text-4" id="text-org777960f">
<p>
As an example, consider computing the sequence of
<b>Fibonacci</b> numbers, in which each number is the sum of the preceding two:
\[0, 1, 1, 2, 3, 5, 8, 13, 21, \cdots\]
</p>

<p>
In general, the Fibonacci numbers can be defined by the rule
</p>


<div class="figure">
<p><img src="./imgs/20170608_113451_5319M0U.png" alt="20170608_113451_5319M0U.png" />
</p>
</div>

<p>
So, we can immediately translate this definition into
a recursive procedure.
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fib</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= n 0<span class="org-rainbow-delimiters-depth-4">)</span> 0<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= n 1<span class="org-rainbow-delimiters-depth-4">)</span> 1<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>+ <span class="org-rainbow-delimiters-depth-5">(</span>fib <span class="org-rainbow-delimiters-depth-6">(</span>- n 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                   <span class="org-rainbow-delimiters-depth-5">(</span>fib <span class="org-rainbow-delimiters-depth-6">(</span>- n 2<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>


<div id="orgea2c88e" class="figure">
<p><img src="./imgs/20170608_113927_5319Z-a.png" alt="20170608_113927_5319Z-a.png" />
</p>
<p><span class="figure-number">Figure 7: </span>The tree-recursive process generated in computing (fib 5)</p>
</div>


<p>
Notice in <a href="#orgea2c88e">Figure</a> that the process of (fib 5) like a tree.
And the entrire computation of (fib 3) is duplicated.
Thus, the process uses a number of steps that grows exponentially with
the input. On the other hand, the space required grows only linearly with the input.
</p>

<p>
We can compute Fibonacci numbers iteratively using the procedure.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fib</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>fib-iter 1 0 n<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fib-iter</span> a b count<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= count 0<span class="org-rainbow-delimiters-depth-3">)</span>
        b
        <span class="org-rainbow-delimiters-depth-3">(</span>fib-iter <span class="org-rainbow-delimiters-depth-4">(</span>+ a b<span class="org-rainbow-delimiters-depth-4">)</span> a <span class="org-rainbow-delimiters-depth-4">(</span>- count 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>


<li><a id="org02e2a63"></a>Example: Counting change<br /><div class="outline-text-4" id="text-org02e2a63">
<p>
This part is more difficult to understand. And it is mainly about
how to change amount of money with n kinds of coins.
<b>Read this part later</b>
</p>
</div></li>


<li><a id="orgd030859"></a>Orders of Growth<br /><div class="outline-text-4" id="text-orgd030859">
<p>
Order of growth provides a useful indication of how we may
expect the behavior of the process to change as we change the size of
the problem. We represent the orders with the symbol of \(\Theta\),
like \(\Theta(n) \; \Theta(n^2) \cdots\).
</p>
</div></li>

<li><a id="org8b0c16e"></a>Exponentiation<br /><div class="outline-text-4" id="text-org8b0c16e">
<p>
Consider the problem of computing the exponential of a
given number. One way to do this is via the recursive definition.
</p>

\begin{align}
b^n & = b \cdot b^{n-1},\\ b^0 & = 1,
\end{align}

<p>
which translates readily into the procedure
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">expt</span> b n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= n 0<span class="org-rainbow-delimiters-depth-3">)</span>
        1
        <span class="org-rainbow-delimiters-depth-3">(</span>* b <span class="org-rainbow-delimiters-depth-4">(</span>expt b <span class="org-rainbow-delimiters-depth-5">(</span>- n 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
This is a linear recursive process, which requires \(\Theta(n)\)
steps and \(\Theta(n)\) space. Just as with factorial, we can
readily formulate an equivalent linear iteration:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">exp</span> b n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>expt-iter b n 1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">expt-iter</span> b counter product<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= counter 0<span class="org-rainbow-delimiters-depth-3">)</span>
        product
        <span class="org-rainbow-delimiters-depth-3">(</span>expt-iter b <span class="org-rainbow-delimiters-depth-4">(</span>- counter 1<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>* b product<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
This version requires \(\Theta(n)\) steps and \(\Theta(1)\) space.
</p>

<p>
We can compute exponentials in fewer steps by using successive
squaring. For instance, rather than computing \(b^8\) as
</p>

<p>
\[b \cdot (b \cdot (b \cdot (b \cdot (b \cdot (b \cdot b)))))\]
</p>

<p>
we can compute it using three multiplication:
</p>

\begin{align}
b^2 & = b \cdot b, \\
b^4 & = b^2 \cdot b^2 \\
b^8 & = b^4 \cdot b^4 \\
\end{align}

<p>
So, we can use the rule:
</p>

\begin{align}
b^n & = (b^{n/2})^2 & \text{if $n$ is even}\\
b^n & = b \cdot b^{n-1} & \text{if $n$ is odd}
\end{align}

<p>
We can express this method as a procedure
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">fast-expt</span> b n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>= n 0<span class="org-rainbow-delimiters-depth-4">)</span> 1<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>even? n<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>square <span class="org-rainbow-delimiters-depth-5">(</span>fast-expt b <span class="org-rainbow-delimiters-depth-6">(</span>/ n 2<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>* b <span class="org-rainbow-delimiters-depth-5">(</span>fast-expt b <span class="org-rainbow-delimiters-depth-6">(</span>- n 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">even?</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder n 2<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
The process has \(\Theta(\log n)\) growth. The difference
between \(\Theta(\log n)\) growth and \(\Theta(n)\) growth becomes striking as \(n\)
becomes large. For example, <i>fast-expt</i> for \(n = 1000\) requireds only 14 multiplication.
</p>
</div></li>

<li><a id="org1c62094"></a>Greatest Common Divisors<br /><div class="outline-text-4" id="text-org1c62094">
<p>
The greatest common divisor(GCD) of two integers \(a\)
and \(b\) is defined to be the largest integer that divides both
\(a\) and \(b\) with no remainder.
</p>

<p>
The idea of the algorithm is based on the observation that, if \(r\) is the
reminder when \(a\) is divided by \(b\), then the common
divisors of \(a\) and \(b\) are precisely the same as the
common divisors of \(b\) and \(r\). Thus, we can use the
equation
\[GCD(a,b) = GCD(b,r)\]
</p>

<p>
For example,
</p>

\begin{align}GCD(206,40) & = GCD(40,6) \\ & = GCD(6,4) \\ & = GCD(4,2) \\ & = GCD(2,0) \\ & = 2\end{align}


<p>
This method for computing the \(GCD\) is known as <b>Euclid's Algorithm</b>.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">gcd</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= b 0<span class="org-rainbow-delimiters-depth-3">)</span>
        a
        <span class="org-rainbow-delimiters-depth-3">(</span>gcd b <span class="org-rainbow-delimiters-depth-4">(</span>remainder a b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
And the order of growth is \(\Theta(\log n)\). You can get the proof in the page of 64.
</p>
</div></li>

<li><a id="org5a16ff6"></a>Example: Testing for primality<br /><div class="outline-text-4" id="text-org5a16ff6">
<blockquote>
<p>
A primality test is an algorithm for determining whether an input
number is prime. -From Wikipedia
</p>
</blockquote>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">smallest-divisor</span> n<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>find-divisor n 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">find-divisor</span> n test-divisor<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>&gt; <span class="org-rainbow-delimiters-depth-5">(</span>square test-divisor<span class="org-rainbow-delimiters-depth-5">)</span> n<span class="org-rainbow-delimiters-depth-4">)</span> n<span class="org-rainbow-delimiters-depth-3">)</span>
              <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>divides? test-divisor n<span class="org-rainbow-delimiters-depth-4">)</span> test-divisor<span class="org-rainbow-delimiters-depth-3">)</span>
              <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>find-divisor n <span class="org-rainbow-delimiters-depth-5">(</span>+ test-divisor 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">divides?</span> a b<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>remainder b a<span class="org-rainbow-delimiters-depth-3">)</span> 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">prime?</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>= n <span class="org-rainbow-delimiters-depth-3">(</span>smallest-divisor n<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>

<p>
We can test whether a number is prime as follows: \(n\) is
prime if and only if \(n\) is its own smallest divisor.
</p>

<p>
The end test for <i>find-divisor</i> is based on the fact that if \(n\)
is not prime it must have a divisor less than or equal
to \(\sqrt n\). This means that the algorithm need only
test divisors between \(1\) and \(\sqrt n\). So the order of growth
is \(\Theta(\sqrt n)\).
</p>
</div></li>


<li><a id="org907fa90"></a>The <a href="https://en.wikipedia.org/wiki/Pierre_de_Fermat">Fermat</a> test<br /><div class="outline-text-4" id="text-org907fa90">
<p>
The \(\Theta(\log n)\) primality test is based on a result
from number theory known as <b>Fermat's Little Theorem</b>.
</p>

<blockquote>
<p>
<b>Fermat’s Little Theorem</b>: If \(n\) is a prime number and \(a\) is any
positive integer less than \(n\), then \(a\) raised to the \(n^{th}\) power is
congruent to \(a\) modulo \(n\).
</p>
</blockquote>

<p>
Given a number \(n\), pick a random number \(a < n\) and compute the
remainder of an modulo \(n\). If the result is not equal to \(a\), then \(n\)
is certainly not prime. If it is \(a\), then chances are good that \(n\)
is prime. Now pick another random number \(a\) and test it with the
same method. If it also satisfies the equation, then we can be
even more confident that \(n\) is prime. By trying more and more
values of \(a\), we can increase our confidence in the result. This
algorithm is known as the <b>Fermat test</b>.
</p>

<p>
The implement of the Fermat test, please see the page of 67.
</p>
</div></li>


<li><a id="orgde7fa10"></a>Probabilistic methods<br /><div class="outline-text-4" id="text-orgde7fa10">
<p>
The Fermat test differs in character from most familiar algorithms,
in which one computes an answer that is guaranteed to be correct.
</p>

<p>
If you want see more detail about this section, you can look at the page of 69.
</p>
</div></li></ul>
</div>

<div id="outline-container-orgda7d459" class="outline-3">
<h3 id="orgda7d459">Formulating Abstractions with Higher-Order Procedures</h3>
<div class="outline-text-3" id="text-orgda7d459">
<p>
Procedures that manipulate procedures are called higher-order procedures.
</p>

<p>
This section shows how higher-order procedures can serve as
powerful abstraction mechanisms, vastly increasing the expressive
power of our language.
</p>
</div>

<ul class="org-ul"><li><a id="org749ae03"></a>Procedures as Arguments \heart<br /><div class="outline-text-4" id="text-org749ae03">
<p>
This part list three procedures and you will find they have the same pattern.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum-integer</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
        0
        <span class="org-rainbow-delimiters-depth-3">(</span>+ a <span class="org-rainbow-delimiters-depth-4">(</span>sum-integer <span class="org-rainbow-delimiters-depth-5">(</span>+ a 1<span class="org-rainbow-delimiters-depth-5">)</span> b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
<p>
And the second computes the sum of the cubes of the
integers in the given range.
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cube</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>* x x x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum-cubes</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
        0
        <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>cube a<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>sum-cubes <span class="org-rainbow-delimiters-depth-5">(</span>+ a 1<span class="org-rainbow-delimiters-depth-5">)</span> b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
The third computes the sum of a sequence of terms in the series.
</p>

\begin{align}
\frac{1}{1 \cdot 3} + \frac{1}{5 \cdot 7} + \frac{1}{9 \cdot 11} + \cdots,
\end{align}

<p>
which converges to \(\pi/8\):
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">pi-sum</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
        0
        <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>/ 1.0 <span class="org-rainbow-delimiters-depth-5">(</span>* a <span class="org-rainbow-delimiters-depth-6">(</span>+ a 2<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
           <span class="org-rainbow-delimiters-depth-4">(</span>pi-sum <span class="org-rainbow-delimiters-depth-5">(</span>+ a 4<span class="org-rainbow-delimiters-depth-5">)</span> b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>


<p>
Now, we could generate each of the procedures by filling in slots int the same template:
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">&lt;name&gt;</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
        0
        <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">&lt;term&gt;</span> a<span class="org-rainbow-delimiters-depth-4">)</span>
           <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">&lt;name&gt;</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-type">&lt;next&gt;</span> a<span class="org-rainbow-delimiters-depth-5">)</span> b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sum</span> term a next b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>&gt; a b<span class="org-rainbow-delimiters-depth-3">)</span>
        0
        <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>term a<span class="org-rainbow-delimiters-depth-4">)</span>
           <span class="org-rainbow-delimiters-depth-4">(</span>sum term <span class="org-rainbow-delimiters-depth-5">(</span>next a<span class="org-rainbow-delimiters-depth-5">)</span> next b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
So, we can define the third one like this
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">pi-sum</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">pi-term</span> x<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>/ 1.0 <span class="org-rainbow-delimiters-depth-4">(</span>* x <span class="org-rainbow-delimiters-depth-5">(</span>+ x 2<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">pi-next</span> x<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>+ x 4<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>sum pi-term a pi-next b<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
Using these procedures, we can compute &pi;.
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>* 8 <span class="org-rainbow-delimiters-depth-2">(</span>pi-sum 1 1000<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
We can computer this with the procedure blow:
</p>


<div class="figure">
<p><img src="./imgs/20170609_094130_5319mIh.png" alt="20170609_094130_5319mIh.png" />
</p>
</div>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">integral</span> f a b dx<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">add-dx</span> x<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>+ x dx<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>* <span class="org-rainbow-delimiters-depth-3">(</span>sum f <span class="org-rainbow-delimiters-depth-4">(</span>+ a <span class="org-rainbow-delimiters-depth-5">(</span>/ dx 2.0<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> add-dx b<span class="org-rainbow-delimiters-depth-3">)</span>
       dx<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>integral cube 0 1 0.01<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>integral cube 0 1 0.001<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>

<li><a id="org1f98ff1"></a>Constructing Procedures Using lambda<br /><div class="outline-text-4" id="text-org1f98ff1">
<p>
We can define a procedure without name. This is the
special form of <b>lambda</b>.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-2">(</span>x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>+ x 4<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">using in pi sum</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">pi-sum</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>sum <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">(</span>x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>/ 1.0 <span class="org-rainbow-delimiters-depth-5">(</span>* x <span class="org-rainbow-delimiters-depth-6">(</span>+ x 2<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
         a
         <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">(</span>x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>+ x 4<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
         b<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
<b>lambda</b> is used to create procedures in the same
way as define, except that no name is specified for the procedure:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">&lt;formal-parameters&gt;</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-type">&lt;body&gt;</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x y z<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>+ x y <span class="org-rainbow-delimiters-depth-4">(</span>square z<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
 1 2 3<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>


<li><a id="org545a8a9"></a>using <b>let</b> to create local variables<br /><div class="outline-text-4" id="text-org545a8a9">
<p>
Suppose we wish to compute the function:
</p>

\begin{align}
f(x,y)=x(1+xy)^2 +y(1−y)+(1+xy)(1−y),
\end{align}

<p>
which we could also express as
</p>
\begin{align}
a & = 1 + xy,\\
b & = 1 - y,\\
f(x,y) & = xa^2 + yb + ab.
\end{align}

<p>
The version one procedure is:
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">f</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">f-helper</span> a b<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>* x <span class="org-rainbow-delimiters-depth-5">(</span>square a<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
           <span class="org-rainbow-delimiters-depth-4">(</span>* y b<span class="org-rainbow-delimiters-depth-4">)</span>
           <span class="org-rainbow-delimiters-depth-4">(</span>* a b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
      <span class="org-rainbow-delimiters-depth-2">(</span>f-helper <span class="org-rainbow-delimiters-depth-3">(</span>+ 1 <span class="org-rainbow-delimiters-depth-4">(</span>* x y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>- 1 y<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
The verson two procedure with lambda is:
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">f</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">(</span>a b<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>+ <span class="org-rainbow-delimiters-depth-5">(</span>* x <span class="org-rainbow-delimiters-depth-6">(</span>square a<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>* y b<span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>* a b<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
     <span class="org-rainbow-delimiters-depth-3">(</span>+ 1 <span class="org-rainbow-delimiters-depth-4">(</span>* x y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
     <span class="org-rainbow-delimiters-depth-3">(</span>- 1 y<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
And the version three using <b>let</b> is:
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">f</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>a <span class="org-rainbow-delimiters-depth-5">(</span>+ 1 <span class="org-rainbow-delimiters-depth-6">(</span>* x y<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
            <span class="org-rainbow-delimiters-depth-4">(</span>b <span class="org-rainbow-delimiters-depth-5">(</span>- 1 y<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>* x <span class="org-rainbow-delimiters-depth-5">(</span>square a<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
           <span class="org-rainbow-delimiters-depth-4">(</span>* y b<span class="org-rainbow-delimiters-depth-4">)</span>
           <span class="org-rainbow-delimiters-depth-4">(</span>* a b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
A <b>let</b> expression is simply syntactic sugar for the
underlying <b>lambda</b> application.
</p>
</div></li>


<li><a id="org6e15012"></a>Procedures as General Methods<br /><div class="outline-text-4" id="text-org6e15012">
<p>
In this section, we'll discuss two more elaborate examples.
One is general methods for finding zeros, and another is fixed points of functions.
</p>
</div>


<ul class="org-ul"><li><a id="orgd1bce4e"></a>Finding roots of equations by the half-interval method.<br /></li>

<li><a id="orgef6f579"></a>Finding fixed points of functions<br /><div class="outline-text-5" id="text-orgef6f579">
<p>
A number \(x\) is called a fixed point of a function f if \(x\) satisfies the equation \(f (x) = x\).
</p>

<p>
For some functions f we can locate a fixed point by beginning with an initial guess and applying f repeatedly,
</p>
\begin{align}
f(x), f(f(x)), f(f(f(x))), \cdots,
\end{align}

<p>
(If you want learn more about fixed point, please visit <a href="https://en.wikipedia.org/wiki/Fixed_point_(mathematics)">here</a>.)
</p>

<p>
We can use this to compute \sqrt, but I can't understand this. <a href="https://briangordon.github.io/2014/06/sqrts-and-fixed-points.html">here</a>
</p>

<p>
\(\sqrt x\) is a fixed-point of the function \(y = x / y\).
</p>
</div></li></ul></li>
<li><a id="orgb812463"></a>Procedures as Returned Values<br /><div class="outline-text-4" id="text-orgb812463">
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">average-damp</span> f<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>average x <span class="org-rainbow-delimiters-depth-4">(</span>f x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span>average-damp square<span class="org-rainbow-delimiters-depth-2">)</span> 10<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="org84f50a9"></a>Newton's method<br /><div class="outline-text-4" id="text-org84f50a9">
<p>
Read later. This part is very interesting.
</p>
</div>
<ul class="org-ul"><li><a id="orgf741fe5"></a>Abstractions and first-class procedures<br /><div class="outline-text-5" id="text-orgf741fe5">
<p>
Some of the “rights and privileges” of first-class elements are:
</p>
<ul class="org-ul">
<li>They may be named by variables.</li>
<li>They may be passed as arguments to procedures.</li>
<li>They may be returned as the results of procedures.</li>
<li>They may be included in data structures.</li>
</ul>
</div></li></ul></li></ul>
</div>
</div>

<div id="outline-container-orge62ca3d" class="outline-2">
<h2 id="orge62ca3d">Chapter 2 Building Abstractions with Data</h2>
<div class="outline-text-2" id="text-orge62ca3d">
</div><div id="outline-container-orgf0f19c6" class="outline-3">
<h3 id="orgf0f19c6">Introduction to Data Abstraction</h3>
<div class="outline-text-3" id="text-orgf0f19c6">
</div><ul class="org-ul"><li><a id="org08ee2af"></a>Example: Arithmetic Operations for Rational Numbers<br /><div class="outline-text-4" id="text-org08ee2af">

<div class="figure">
<p><img src="./imgs/20170615_142951_55502L2y.png" alt="20170615_142951_55502L2y.png" />
</p>
</div>


<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">add-rat</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>make-rat <span class="org-rainbow-delimiters-depth-3">(</span>+ <span class="org-rainbow-delimiters-depth-4">(</span>* <span class="org-rainbow-delimiters-depth-5">(</span>numer x<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>denom y<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                 <span class="org-rainbow-delimiters-depth-4">(</span>* <span class="org-rainbow-delimiters-depth-5">(</span>numer y<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>denom x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
              <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>denom x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>denom y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">sub-rat</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>make-rat <span class="org-rainbow-delimiters-depth-3">(</span>- <span class="org-rainbow-delimiters-depth-4">(</span>* <span class="org-rainbow-delimiters-depth-5">(</span>numer x<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>denom y<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
                       <span class="org-rainbow-delimiters-depth-4">(</span>* <span class="org-rainbow-delimiters-depth-5">(</span>numer y<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>denom x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                    <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>denom x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>denom y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">mul-rat</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>make-rat <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>numer x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>numer y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>denom x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>denom y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">div-rat</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
      <span class="org-rainbow-delimiters-depth-2">(</span>make-rat <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>numer x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>denom y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>denom x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>numer y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">equal-rat?</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>= <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>numer x<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>denom y<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
         <span class="org-rainbow-delimiters-depth-3">(</span>* <span class="org-rainbow-delimiters-depth-4">(</span>numer y<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>denom x<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="orgcece7db"></a>Pairs<br /><div class="outline-text-4" id="text-orgcece7db">
<p>
Data objects constructed from pairs are called list-structured data.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">x</span> <span class="org-rainbow-delimiters-depth-2">(</span>cons 1 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>car x<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">1</span>
<span class="org-rainbow-delimiters-depth-1">(</span>cdr x<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">2</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">x</span> <span class="org-rainbow-delimiters-depth-2">(</span>cons 1 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">y</span> <span class="org-rainbow-delimiters-depth-2">(</span>cons 3 4<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">z</span> <span class="org-rainbow-delimiters-depth-2">(</span>cons x y<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>car <span class="org-rainbow-delimiters-depth-2">(</span>car z<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
1
<span class="org-rainbow-delimiters-depth-1">(</span>car <span class="org-rainbow-delimiters-depth-2">(</span>cdr z<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> 3
</code></pre>
</div>
</div></li>
<li><a id="orge5e7592"></a>Representing rational numbers<br /><div class="outline-text-4" id="text-orge5e7592">
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">make-rat</span> n d<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>cons n d<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">numer</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>car x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">denom</span> x<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>cdr x<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">print-rat</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>newline<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>display <span class="org-rainbow-delimiters-depth-3">(</span>numer x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>display <span class="org-string">"/"</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>display <span class="org-rainbow-delimiters-depth-3">(</span>denom x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">one-half</span> <span class="org-rainbow-delimiters-depth-2">(</span>make-rat 1 2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>print-rat one-half<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">one-third</span> <span class="org-rainbow-delimiters-depth-2">(</span>make-rat 1 3<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>print-rat <span class="org-rainbow-delimiters-depth-2">(</span>add-rat one-half one-third<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>
<p>
As the final example shows, our rational-number implementation does not reduce rational numbers to lowest terms. We can remedy this by changing make-rat.
</p>

<p>
In this place, we can use <b>gcd</b> to solve this problem.
</p>

<div class="container">
<pre><code class="scheme">The gcd function don't need to compare which one is bigger.

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">gcd</span> a b<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= b 0<span class="org-rainbow-delimiters-depth-3">)</span>
        a
        <span class="org-rainbow-delimiters-depth-3">(</span>gcd b <span class="org-rainbow-delimiters-depth-4">(</span>remainder a b<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>

<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">make-rat</span> n d<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>g <span class="org-rainbow-delimiters-depth-6">(</span>gcd n d<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>cons <span class="org-rainbow-delimiters-depth-5">(</span>/ n g<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>/ d g<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>

<span class="org-rainbow-delimiters-depth-2">(</span>print-rat <span class="org-rainbow-delimiters-depth-3">(</span>add-rat one-third one-third<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">now we have 2/3</span>
</code></pre>
</div>
</div></li>
<li><a id="orge284121"></a>What Is Meant by Data?<br /><div class="outline-text-4" id="text-orge284121">
<p>
This point is illustrated strikingly by the fact that we could implement cons, car, and cdr without using any data structures at all but only using procedures. Here are the definitions:
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cons</span> x y<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">dispatch</span> m<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>= m 0<span class="org-rainbow-delimiters-depth-5">)</span> x<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>= m 1<span class="org-rainbow-delimiters-depth-5">)</span> y<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-5">(</span>error <span class="org-string">"Argument not 0 or 1: CONS"</span> m<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    dispatch<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">car</span> z<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>z 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">cdr</span> z<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>z 1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="orgf1738e2"></a><span class="todo TODO">TODO</span> Extended Exercise: Interval Arithmetic<br /></li></ul>
</div>
<div id="outline-container-org5a46b9c" class="outline-3">
<h3 id="org5a46b9c">Hierarchical Data and the Closure Property</h3>
<div class="outline-text-3" id="text-org5a46b9c">

<div class="figure">
<p><img src="./imgs/20170615_191542_555029_B.png" alt="20170615_191542_555029_B.png" />
</p>
</div>
</div>
<ul class="org-ul"><li><a id="orgfcb804e"></a>Representing Sequences<br /><div class="outline-text-4" id="text-orgfcb804e">

<div class="figure">
<p><img src="./imgs/20170615_192242_55502KKI.png" alt="20170615_192242_55502KKI.png" />
</p>
</div>


<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>cons 1
  <span class="org-rainbow-delimiters-depth-2">(</span>cons 2
        <span class="org-rainbow-delimiters-depth-3">(</span>cons 3
              <span class="org-rainbow-delimiters-depth-4">(</span>cons 4 nil<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
Such a sequence of pairs, formed by nested conses, is called a list,
</p>

<p>
Scheme provides a primitive called list to help in constructing lists.
The above sequence could be produced by (list 1 2 3 4). In general,
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>list <span class="org-rainbow-delimiters-depth-2">&#10216;</span>a1<span class="org-rainbow-delimiters-depth-2">&#10217;</span> <span class="org-rainbow-delimiters-depth-2">&#10216;</span>a2<span class="org-rainbow-delimiters-depth-2">&#10217;</span> . . . <span class="org-rainbow-delimiters-depth-2">&#10216;</span>an<span class="org-rainbow-delimiters-depth-2">&#10217;</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
is equivalent to
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>cons <span class="org-rainbow-delimiters-depth-2">&#10216;</span>a1<span class="org-rainbow-delimiters-depth-2">&#10217;</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>cons <span class="org-rainbow-delimiters-depth-3">&#10216;</span>a2<span class="org-rainbow-delimiters-depth-3">&#10217;</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>cons . . .
            <span class="org-rainbow-delimiters-depth-4">(</span>cons <span class="org-rainbow-delimiters-depth-5">&#10216;</span>an<span class="org-rainbow-delimiters-depth-5">&#10217;</span>
                nil<span class="org-rainbow-delimiters-depth-4">)</span>. . .<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>

<p>
Be careful not to confuse the expression (list 1 2 3 4) with the list (1 2 3 4), which is the result obtained when the expression is evaluated.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>cons 10 one-through-four<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>10 1 2 3 4<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="orgb11c515"></a>List operations<br /><div class="outline-text-4" id="text-orgb11c515">
<p>
The procedure <b>list-ref</b> takes as arguments a list and a
number <b>n</b> and returen the \(n^{th}\) item of the list.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">list-ref</span> items n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>= n 0<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>car items<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span>list-ref <span class="org-rainbow-delimiters-depth-4">(</span>cdr items<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>- n 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">squares</span> <span class="org-rainbow-delimiters-depth-2">(</span>list 1 4 9 16 25<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>list-ref squares 3<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">length</span> items<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>null? items<span class="org-rainbow-delimiters-depth-3">)</span>
        0
        <span class="org-rainbow-delimiters-depth-3">(</span>+ 1 <span class="org-rainbow-delimiters-depth-4">(</span>length <span class="org-rainbow-delimiters-depth-5">(</span>cdr items<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">odds</span> <span class="org-rainbow-delimiters-depth-2">(</span>list 1 3 5<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>length odds<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
We also can compute <b>length</b> in an iterative style:
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">length</span> items<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">length-iter</span> a count<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>null? a<span class="org-rainbow-delimiters-depth-4">)</span>
            count
            <span class="org-rainbow-delimiters-depth-4">(</span>length-iter <span class="org-rainbow-delimiters-depth-5">(</span>cdr a<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-5">(</span>+ 1 count<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>length-iter items 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>append squares odds<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>1 4 9 16 25 1 3 5 7<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
<b>append</b> is also implemented using a recursive plan.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">append</span> list1 list2<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>null? list1<span class="org-rainbow-delimiters-depth-3">)</span>
        list2
        <span class="org-rainbow-delimiters-depth-3">(</span>cons <span class="org-rainbow-delimiters-depth-4">(</span>car list1<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>append <span class="org-rainbow-delimiters-depth-5">(</span>cdr list1<span class="org-rainbow-delimiters-depth-5">)</span> list2<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="orgd7b3bd8"></a>Mapping over lists<br /><div class="outline-text-4" id="text-orgd7b3bd8">
<p>
For instance, the following procedure scales each number in a list by a given factor:
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">scale-list</span> items factor<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>null? items<span class="org-rainbow-delimiters-depth-3">)</span>
        nil
        <span class="org-rainbow-delimiters-depth-3">(</span>cons <span class="org-rainbow-delimiters-depth-4">(</span>* <span class="org-rainbow-delimiters-depth-5">(</span>car items<span class="org-rainbow-delimiters-depth-5">)</span> factor<span class="org-rainbow-delimiters-depth-4">)</span>
              <span class="org-rainbow-delimiters-depth-4">(</span>scale-list <span class="org-rainbow-delimiters-depth-5">(</span>cdr items<span class="org-rainbow-delimiters-depth-5">)</span> factor<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
We can abstract this general idea and capture it as
a common pattern expressed as a higher-order procedure.
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">map</span> proc items<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>null? items<span class="org-rainbow-delimiters-depth-3">)</span>
        nil
        <span class="org-rainbow-delimiters-depth-3">(</span>cons <span class="org-rainbow-delimiters-depth-4">(</span>proc <span class="org-rainbow-delimiters-depth-5">(</span>car items<span class="org-rainbow-delimiters-depth-5">)</span>
              <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">map</span> proc <span class="org-rainbow-delimiters-depth-6">(</span>cdr items<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">map</span> abs <span class="org-rainbow-delimiters-depth-2">(</span>list -10 2.5 -11.6<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">map</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>* x x<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>list 1 2 3 4<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="orga6662a3"></a>Hierarchical Structures<br /><div class="outline-text-4" id="text-orga6662a3">

<div class="figure">
<p><img src="./imgs/20170616_110339_66786ZXz.png" alt="20170616_110339_66786ZXz.png" />
</p>
<p><span class="figure-number">Figure 12: </span>Structure formed by (cons (list 1 2) (list 3 4)).</p>
</div>

<p>
Another way to think of sequences whose elements are sequences is as trees.
</p>


<div class="figure">
<p><img src="./imgs/20170616_110544_66786LhC.png" alt="20170616_110544_66786LhC.png" />
</p>
</div>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-function-name">x</span> <span class="org-rainbow-delimiters-depth-2">(</span>cons <span class="org-rainbow-delimiters-depth-3">(</span>list 1 2<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>list 3 4<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>length x<span class="org-rainbow-delimiters-depth-1">)</span>
3
<span class="org-rainbow-delimiters-depth-1">(</span>count-leaves x<span class="org-rainbow-delimiters-depth-1">)</span>
4
<span class="org-rainbow-delimiters-depth-1">(</span>list x x<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>1 2<span class="org-rainbow-delimiters-depth-3">)</span> 3 4<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>1 2<span class="org-rainbow-delimiters-depth-3">)</span> 3 4<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">count-leaves</span> x<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>null? x<span class="org-rainbow-delimiters-depth-4">)</span> 0<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>not <span class="org-rainbow-delimiters-depth-5">(</span>pair? x<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> 1<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>+ <span class="org-rainbow-delimiters-depth-5">(</span>count-leaves <span class="org-rainbow-delimiters-depth-6">(</span>car x<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                   <span class="org-rainbow-delimiters-depth-5">(</span>count-leaves <span class="org-rainbow-delimiters-depth-6">(</span>cdr x<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
Scheme provides the primitive predicate <b>pair?</b>, which tests whether its argument is a pair.
</p>
</div></li>
<li><a id="org5a00e38"></a>Mapping over trees<br /><div class="outline-text-4" id="text-org5a00e38">
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">scale-tree</span> tree factor<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>null? tree<span class="org-rainbow-delimiters-depth-4">)</span> nil<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>not <span class="org-rainbow-delimiters-depth-5">(</span>pair? tree<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>* tree factor<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>cons <span class="org-rainbow-delimiters-depth-5">(</span>scale-tree <span class="org-rainbow-delimiters-depth-6">(</span>car tree<span class="org-rainbow-delimiters-depth-6">)</span> factor<span class="org-rainbow-delimiters-depth-5">)</span>
                      <span class="org-rainbow-delimiters-depth-5">(</span>scale-tree <span class="org-rainbow-delimiters-depth-6">(</span>cdr tree<span class="org-rainbow-delimiters-depth-6">)</span> factor<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
Another way is using map:
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">scale-tree</span> tree factor<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">map</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">(</span>sub-tree<span class="org-rainbow-delimiters-depth-4">)</span>
            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-5">(</span>pair? subtree<span class="org-rainbow-delimiters-depth-5">)</span>
                <span class="org-rainbow-delimiters-depth-5">(</span>scale-tree subtree factor<span class="org-rainbow-delimiters-depth-5">)</span>
                * sub-tree factor<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
         map<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="org8c5eed0"></a>Sequences as Conventional Interfaces &check;<br /><div class="outline-text-4" id="text-org8c5eed0">
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">even-fibs</span> n<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-function-name">next</span> k<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>&gt; k n<span class="org-rainbow-delimiters-depth-4">)</span>
            nil
            <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-rainbow-delimiters-depth-6">(</span>f <span class="org-rainbow-delimiters-depth-7">(</span>fib k<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-6">(</span>even? f<span class="org-rainbow-delimiters-depth-6">)</span>
                    <span class="org-rainbow-delimiters-depth-6">(</span>cons f <span class="org-rainbow-delimiters-depth-7">(</span>next <span class="org-rainbow-delimiters-depth-8">(</span>+ k 1<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                    <span class="org-rainbow-delimiters-depth-6">(</span>next <span class="org-rainbow-delimiters-depth-7">(</span>+ k 1<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>next 0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
Filtering a sequence to select only those elements that satisfy a given predicate is accomplished by
</p>

<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">filter</span> predicate sequence<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>null? sequence<span class="org-rainbow-delimiters-depth-4">)</span> nil<span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>predicate <span class="org-rainbow-delimiters-depth-5">(</span>car sequence<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
            <span class="org-rainbow-delimiters-depth-4">(</span>cons <span class="org-rainbow-delimiters-depth-5">(</span>car sequence<span class="org-rainbow-delimiters-depth-5">)</span>
                <span class="org-rainbow-delimiters-depth-5">(</span>filter predicate <span class="org-rainbow-delimiters-depth-6">(</span>cdr sequence<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
          <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-4">(</span>filter predicate <span class="org-rainbow-delimiters-depth-5">(</span>cdr sequence<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>

<p>
For example,
</p>
<pre><code class="example">
(filter odd? (list 1 2 3 4 5))
(1 3 5)
</code></pre>

<p>
Accumulations can be implemented by
</p>
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-function-name">accumulate</span> op initial sequence<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>null? sequence<span class="org-rainbow-delimiters-depth-3">)</span>
      initial
      <span class="org-rainbow-delimiters-depth-3">(</span>op <span class="org-rainbow-delimiters-depth-4">(</span>car sequence<span class="org-rainbow-delimiters-depth-4">)</span>
          <span class="org-rainbow-delimiters-depth-4">(</span>accumulate op initial <span class="org-rainbow-delimiters-depth-5">(</span>cdr sequence<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div></li>
<li><a id="org4ea7cb6"></a>Nested Mappings<br /><div class="outline-text-4" id="text-org4ea7cb6">
<div class="container">
<pre><code class="scheme"><span class="org-rainbow-delimiters-depth-1">(</span>accumulate
    append nil <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">map</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-4">(</span>i<span class="org-rainbow-delimiters-depth-4">)</span>
                    <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">map</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-6">(</span>j<span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-rainbow-delimiters-depth-6">(</span>list i j<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
                        <span class="org-rainbow-delimiters-depth-5">(</span>enumerate-interval 1 <span class="org-rainbow-delimiters-depth-6">(</span>- i 1<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
                 <span class="org-rainbow-delimiters-depth-3">(</span>enumerate-interval 1 n<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

</code></pre>
</div>
</div></li>
<li><a id="org620ee1d"></a>Example: A Picture Language<br /></li></ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/datejs/1.0/date.min.js"></script>

<script>
var base_url = 'https://api.github.com';
var title = document.title;
var owner = 'yydai';
var repo = 'yydai.github.io';
var search_issues = base_url + '/search/issues?q=' + title + '+user:' + owner + '+label:blog'+ '+state:open';

console.log("search_issues = "+ search_issues);

function test() {
  jQuery.ajax({
      type: 'GET',
      async: false,
      dataType:'json',
      url: search_issues,
      success:function(data) {
         result = data;
      }
  });
  return result;
}
var result = test();
var items = result.items[0];
if(jQuery.isEmptyObject(items)) {
    create(title);
} else {
    html_url = items.html_url;
	document.body.innerHTML +=
'<div id="comments"><h2>Comments</h2><div id="header">Want to leave a comment? Visit <a href="'+ html_url + '"> this issue page on GitHub</a> (you will need a GitHub account).</div></div>'
}


function create(title) {
	var create_url = 'https://blog-api-server.herokuapp.com/issues?title=' + title + '&labels=blog&body=Welcome to leave comments here.&owner=yydai&repo=yydai.github.io&auth=eXlkYWk6ZGVpc3Q5MjgxNw=='

	jQuery.ajax({
      type: 'GET',
      async: false,
      dataType:'json',
      url: create_url,
      success:function(data) {
         result = data;
      }
  });
}


console.log("total_count = " + result.total_count);
if(result.total_count == 1) {
    var comments_url = result.items[0].comments_url;
} else if (result.total_count == 0) {
        // create a new issue
    //create(title);
} else {
        // result not only
        alert('Cannot load the comments.');
}

function loadComments(data) {
	repo = 'github.com'
    for (var i=0; i<data.length; i++) {
      var cuser = data[i].user.login;
      var cuserlink = 'https://' + repo + '/' + data[i].user.login;
      var cbody = data[i].body_html;
      var cavatarlink = data[i].user.avatar_url;
      var cdate = Date.parse(data[i].created_at).toString('yyyy-MM-dd HH:mm:ss');

	  var html_url = items.html_url + '#issuecomment-' + data[i].url.substring(data[i].url.lastIndexOf('/')+1);

      var code = '<div class="comment"><div class="commentheader"><div class="commentgravatar">' + '<img src="' + cavatarlink + '" alt="" width="20" height="20">' + '</div><a class="commentuser" href="'+ cuserlink + '">' + cuser + '</a><a class="commentdate" href="' + html_url + '">' + cdate + '</a></div><div class="commentbody">' + cbody + '</div></div>';

      $('#comments').append(code);
    }
  }


var comments_api = comments_url + '?per_page=100';
console.log("comments api: " + comments_api);
$.ajax(comments_api, {
    headers: {Accept: 'application/vnd.github.full+json'},
    dataType: 'json',
    success: function(msg){
      loadComments(msg);
   }
  });


</script>

<hr />
 <div class='footer'>
© 2017 yydai<br/>
Email: dai92817@icloud.com
</div>
</div>
</body>
</html>
